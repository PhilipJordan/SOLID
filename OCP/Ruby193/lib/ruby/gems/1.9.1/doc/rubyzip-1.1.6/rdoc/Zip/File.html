<?xml version="1.0" encoding="IBM437"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <meta content="text/html; charset=IBM437" http-equiv="Content-Type" />

  <title>Class: Zip::File</title>

  <link rel="stylesheet" href="../rdoc.css" type="text/css" media="screen" />

  <script src="../js/jquery.js" type="text/javascript" charset="utf-8"></script>
  <script src="../js/thickbox-compressed.js" type="text/javascript" charset="utf-8"></script>
  <script src="../js/quicksearch.js" type="text/javascript" charset="utf-8"></script>
  <script src="../js/darkfish.js" type="text/javascript" charset="utf-8"></script>

</head>
<body id="top" class="class">

  <div id="metadata">
    <div id="home-metadata">
      <div id="home-section" class="section">
        <h3 class="section-header">
          <a href="../index.html">Home</a>
          <a href="../index.html#classes">Classes</a>
          <a href="../index.html#methods">Methods</a>
        </h3>
      </div>
    </div>

    <div id="file-metadata">
      <div id="file-list-section" class="section">
        <h3 class="section-header">In Files</h3>
        <div class="section-body">
          <ul>
          
            <li><a href="../lib/zip/file_rb.html?TB_iframe=true&amp;height=550&amp;width=785"
              class="thickbox" title="lib/zip/file.rb">lib/zip/file.rb</a></li>
          
            <li><a href="../lib/zip/filesystem_rb.html?TB_iframe=true&amp;height=550&amp;width=785"
              class="thickbox" title="lib/zip/filesystem.rb">lib/zip/filesystem.rb</a></li>
          
          </ul>
        </div>
      </div>

      
    </div>

    <div id="class-metadata">
      
      <!-- Parent Class -->
      <div id="parent-class-section" class="section">
        <h3 class="section-header">Parent</h3>
        
        <p class="link"><a href="CentralDirectory.html">Zip::CentralDirectory</a></p>
        
      </div>
      

      

      

      
      <!-- Method Quickref -->
      <div id="method-list-section" class="section">
        <h3 class="section-header">Methods</h3>
        <ul class="link-list">
          
          <li><a href="#method-c-add_buffer">::add_buffer</a></li>
          
          <li><a href="#method-c-foreach">::foreach</a></li>
          
          <li><a href="#method-c-get_partial_zip_file_name">::get_partial_zip_file_name</a></li>
          
          <li><a href="#method-c-get_segment_count_for_split">::get_segment_count_for_split</a></li>
          
          <li><a href="#method-c-get_segment_size_for_split">::get_segment_size_for_split</a></li>
          
          <li><a href="#method-c-new">::new</a></li>
          
          <li><a href="#method-c-open">::open</a></li>
          
          <li><a href="#method-c-open_buffer">::open_buffer</a></li>
          
          <li><a href="#method-c-put_split_signature">::put_split_signature</a></li>
          
          <li><a href="#method-c-save_splited_part">::save_splited_part</a></li>
          
          <li><a href="#method-c-split">::split</a></li>
          
          <li><a href="#method-i-add">#add</a></li>
          
          <li><a href="#method-i-close">#close</a></li>
          
          <li><a href="#method-i-commit">#commit</a></li>
          
          <li><a href="#method-i-commit_required-3F">#commit_required?</a></li>
          
          <li><a href="#method-i-extract">#extract</a></li>
          
          <li><a href="#method-i-find_entry">#find_entry</a></li>
          
          <li><a href="#method-i-get_entry">#get_entry</a></li>
          
          <li><a href="#method-i-get_input_stream">#get_input_stream</a></li>
          
          <li><a href="#method-i-get_output_stream">#get_output_stream</a></li>
          
          <li><a href="#method-i-glob">#glob</a></li>
          
          <li><a href="#method-i-mkdir">#mkdir</a></li>
          
          <li><a href="#method-i-read">#read</a></li>
          
          <li><a href="#method-i-remove">#remove</a></li>
          
          <li><a href="#method-i-rename">#rename</a></li>
          
          <li><a href="#method-i-replace">#replace</a></li>
          
          <li><a href="#method-i-to_s">#to_s</a></li>
          
          <li><a href="#method-i-write_buffer">#write_buffer</a></li>
          
        </ul>
      </div>
      

      
      <!-- Included Modules -->
      <div id="includes-section" class="section">
        <h3 class="section-header">Included Modules</h3>
        <ul class="link-list">
        
        
          <li><a class="include" href="FileSystem.html">Zip::FileSystem</a></li>
        
        
        </ul>
      </div>
      
    </div>

    <div id="project-metadata">
      
      

      <div id="classindex-section" class="section project-section">
        <h3 class="section-header">Class/Module Index
          <span class="search-toggle"><img src="../images/find.png"
            height="16" width="16" alt="[+]"
            title="show/hide quicksearch" /></span></h3>
        <form action="#" method="get" accept-charset="utf-8" class="initially-hidden">
        <fieldset>
          <legend>Quicksearch</legend>
          <input type="text" name="quicksearch" value=""
            class="quicksearch-field" />
        </fieldset>
        </form>

        <ul class="link-list">
        
          <li><a href="../Zip.html">Zip</a></li>
        
          <li><a href="../Zip/CentralDirectory.html">Zip::CentralDirectory</a></li>
        
          <li><a href="../Zip/CompressionMethodError.html">Zip::CompressionMethodError</a></li>
        
          <li><a href="../Zip/DestinationFileExistsError.html">Zip::DestinationFileExistsError</a></li>
        
          <li><a href="../Zip/Entry.html">Zip::Entry</a></li>
        
          <li><a href="../Zip/EntryExistsError.html">Zip::EntryExistsError</a></li>
        
          <li><a href="../Zip/EntryNameError.html">Zip::EntryNameError</a></li>
        
          <li><a href="../Zip/Error.html">Zip::Error</a></li>
        
          <li><a href="../Zip/ExtraField.html">Zip::ExtraField</a></li>
        
          <li><a href="../Zip/ExtraField/Generic.html">Zip::ExtraField::Generic</a></li>
        
          <li><a href="../Zip/ExtraField/IUnix.html">Zip::ExtraField::IUnix</a></li>
        
          <li><a href="../Zip/ExtraField/OldUnix.html">Zip::ExtraField::OldUnix</a></li>
        
          <li><a href="../Zip/ExtraField/UniversalTime.html">Zip::ExtraField::UniversalTime</a></li>
        
          <li><a href="../Zip/ExtraField/Zip64.html">Zip::ExtraField::Zip64</a></li>
        
          <li><a href="../Zip/ExtraField/Zip64Placeholder.html">Zip::ExtraField::Zip64Placeholder</a></li>
        
          <li><a href="../Zip/File.html">Zip::File</a></li>
        
          <li><a href="../Zip/FileSystem.html">Zip::FileSystem</a></li>
        
          <li><a href="../Zip/FileSystem/ZipFsDir.html">Zip::FileSystem::ZipFsDir</a></li>
        
          <li><a href="../Zip/FileSystem/ZipFsFile.html">Zip::FileSystem::ZipFsFile</a></li>
        
          <li><a href="../Zip/FileSystem/ZipFsFile/ZipFsStat.html">Zip::FileSystem::ZipFsFile::ZipFsStat</a></li>
        
          <li><a href="../Zip/IOExtras.html">Zip::IOExtras</a></li>
        
          <li><a href="../Zip/IOExtras/AbstractInputStream.html">Zip::IOExtras::AbstractInputStream</a></li>
        
          <li><a href="../Zip/IOExtras/AbstractOutputStream.html">Zip::IOExtras::AbstractOutputStream</a></li>
        
          <li><a href="../Zip/IOExtras/FakeIO.html">Zip::IOExtras::FakeIO</a></li>
        
          <li><a href="../Zip/InputStream.html">Zip::InputStream</a></li>
        
          <li><a href="../Zip/InternalError.html">Zip::InternalError</a></li>
        
          <li><a href="../Zip/OutputStream.html">Zip::OutputStream</a></li>
        
          <li><a href="../Zip/StreamableDirectory.html">Zip::StreamableDirectory</a></li>
        
          <li><a href="../Zip/StreamableStream.html">Zip::StreamableStream</a></li>
        
          <li><a href="../Zip/CompressionMethodError.html">Zip::ZipCompressionMethodError</a></li>
        
          <li><a href="../Zip/DestinationFileExistsError.html">Zip::ZipDestinationFileExistsError</a></li>
        
          <li><a href="../Zip/EntryExistsError.html">Zip::ZipEntryExistsError</a></li>
        
          <li><a href="../Zip/EntryNameError.html">Zip::ZipEntryNameError</a></li>
        
          <li><a href="../Zip/Error.html">Zip::ZipError</a></li>
        
          <li><a href="../Zip/InternalError.html">Zip::ZipInternalError</a></li>
        
        </ul>
        <div id="no-class-search-results" style="display: none;">No matching classes.</div>
      </div>

      
    </div>
  </div>

  <div id="documentation">
    <h1 class="class">Zip::File</h1>

    <div id="description" class="description">
      
<p>ZipFile is modeled after java.util.zip.ZipFile from the Java SDK. The most
important methods are those inherited from ZipCentralDirectory for
accessing information about the entries in the archive and methods such as
<a href="File.html#method-i-get_input_stream">get_input_stream</a> and <a
href="File.html#method-i-get_output_stream">get_output_stream</a> for
reading from and writing entries to the archive. The class includes a few
convenience methods such as <a
href="File.html#method-i-extract">extract</a> for extracting entries to the
filesystem, and <a href="File.html#method-i-remove">remove</a>, <a
href="File.html#method-i-replace">replace</a>, <a
href="File.html#method-i-rename">rename</a> and <a
href="File.html#method-i-mkdir">mkdir</a> for making simple modifications
to the archive.</p>

<p>Modifications to a zip archive are not committed until <a
href="File.html#method-i-commit">commit</a> or <a
href="File.html#method-i-close">close</a> is called. The method open
accepts a block following the pattern from <a
href="File.html#method-c-open">File.open</a> offering a simple way to
automatically close the archive when the block returns.</p>

<p>The following example opens zip archive <tt>my.zip</tt> (creating it if it
doesn't exist) and adds an entry <tt>first.txt</tt> and a directory entry
<tt>a_dir</tt> to it.</p>

<pre>require 'zip'

Zip::File.open(&quot;my.zip&quot;, Zip::File::CREATE) {
 |zipfile|
  zipfile.get_output_stream(&quot;first.txt&quot;) { |f| f.puts &quot;Hello from ZipFile&quot; }
  zipfile.mkdir(&quot;a_dir&quot;)
}</pre>

<p>The next example reopens <tt>my.zip</tt> writes the contents of
<tt>first.txt</tt> to standard out and deletes the entry from the archive.</p>

<pre>require 'zip'

Zip::File.open(&quot;my.zip&quot;, Zip::File::CREATE) {
  |zipfile|
  puts zipfile.read(&quot;first.txt&quot;)
  zipfile.remove(&quot;first.txt&quot;)
}</pre>

<p>ZipFileSystem offers an alternative API that emulates ruby's interface for
accessing the filesystem, ie. the <a href="File.html">File</a> and Dir
classes.</p>

    </div><!-- description -->

    
    
    
    <div id="5Buntitled-5D" class="documentation-section">
      

      

      
      <!-- Constants -->
      <div id="constants-list" class="section">
        <h3 class="section-header">Constants</h3>
        <dl>
        
          <dt><a name="CREATE">CREATE</a></dt>
          
          <dd class="description"></dd>
          
        
          <dt><a name="DATA_BUFFER_SIZE">DATA_BUFFER_SIZE</a></dt>
          
          <dd class="description"></dd>
          
        
          <dt><a name="MAX_SEGMENT_SIZE">MAX_SEGMENT_SIZE</a></dt>
          
          <dd class="description"></dd>
          
        
          <dt><a name="MIN_SEGMENT_SIZE">MIN_SEGMENT_SIZE</a></dt>
          
          <dd class="description"></dd>
          
        
          <dt><a name="SPLIT_SIGNATURE">SPLIT_SIGNATURE</a></dt>
          
          <dd class="description"></dd>
          
        
          <dt><a name="ZIP64_EOCD_SIGNATURE">ZIP64_EOCD_SIGNATURE</a></dt>
          
          <dd class="description"></dd>
          
        
        </dl>
      </div>
      

      
      <!-- Attributes -->
      <div id="attribute-method-details" class="method-section section">
        <h3 class="section-header">Attributes</h3>

        
        <div id="comment-attribute-method" class="method-detail">
          <a name="comment"></a>
          
          <a name="comment="></a>
          
          <div class="method-heading attribute-method-heading">
            <span class="method-name">comment</span><span
              class="attribute-access-type">[RW]</span>
          </div>

          <div class="method-description">
          
          <p>Returns the zip files comment, if it has one</p>
          
          </div>
        </div>
        
        <div id="name-attribute-method" class="method-detail">
          <a name="name"></a>
          
          <div class="method-heading attribute-method-heading">
            <span class="method-name">name</span><span
              class="attribute-access-type">[R]</span>
          </div>

          <div class="method-description">
          
          
          
          </div>
        </div>
        
        <div id="restore_ownership-attribute-method" class="method-detail">
          <a name="restore_ownership"></a>
          
          <a name="restore_ownership="></a>
          
          <div class="method-heading attribute-method-heading">
            <span class="method-name">restore_ownership</span><span
              class="attribute-access-type">[RW]</span>
          </div>

          <div class="method-description">
          
          <p>default -&gt; false</p>
          
          </div>
        </div>
        
        <div id="restore_permissions-attribute-method" class="method-detail">
          <a name="restore_permissions"></a>
          
          <a name="restore_permissions="></a>
          
          <div class="method-heading attribute-method-heading">
            <span class="method-name">restore_permissions</span><span
              class="attribute-access-type">[RW]</span>
          </div>

          <div class="method-description">
          
          <p>default -&gt; false</p>
          
          </div>
        </div>
        
        <div id="restore_times-attribute-method" class="method-detail">
          <a name="restore_times"></a>
          
          <a name="restore_times="></a>
          
          <div class="method-heading attribute-method-heading">
            <span class="method-name">restore_times</span><span
              class="attribute-access-type">[RW]</span>
          </div>

          <div class="method-description">
          
          <p>default -&gt; true</p>
          
          </div>
        </div>
        
      </div><!-- attribute-method-details -->
      

      <!-- Methods -->
      
      <div id="public-class-method-details" class="method-section section">
        <h3 class="section-header">Public Class Methods</h3>

      
        <div id="add_buffer-method" class="method-detail ">
          <a name="method-c-add_buffer"></a>

          
          <div class="method-heading">
            <span class="method-name">add_buffer</span><span
              class="method-args">()</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Same as open. But outputs data to a buffer instead of a file</p>
            

            
            <div class="method-source-code" id="add_buffer-source">
<pre>
<span class="ruby-comment"># File lib/zip/file.rb, line 106</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">add_buffer</span>
  <span class="ruby-identifier">io</span> = <span class="ruby-operator">::</span><span class="ruby-constant">StringIO</span>.<span class="ruby-identifier">new</span>(<span class="ruby-string">''</span>)
  <span class="ruby-identifier">zf</span> = <span class="ruby-operator">::</span><span class="ruby-constant">Zip</span><span class="ruby-operator">::</span><span class="ruby-constant">File</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">io</span>, <span class="ruby-keyword">true</span>, <span class="ruby-keyword">true</span>)
  <span class="ruby-keyword">yield</span> <span class="ruby-identifier">zf</span>
  <span class="ruby-identifier">zf</span>.<span class="ruby-identifier">write_buffer</span>(<span class="ruby-identifier">io</span>)
<span class="ruby-keyword">end</span></pre>
            </div><!-- add_buffer-source -->
            
          </div>

          

          
        </div><!-- add_buffer-method -->

      
        <div id="foreach-method" class="method-detail ">
          <a name="method-c-foreach"></a>

          
          <div class="method-heading">
            <span class="method-name">foreach</span><span
              class="method-args">(aZipFileName, &block)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Iterates over the contents of the ZipFile. This is more efficient than
using a ZipInputStream since this methods simply iterates through the
entries in the central directory structure in the archive whereas
ZipInputStream jumps through the entire archive accessing the local entry
headers (which contain the same information as the central directory).</p>
            

            
            <div class="method-source-code" id="foreach-source">
<pre>
<span class="ruby-comment"># File lib/zip/file.rb, line 137</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">foreach</span>(<span class="ruby-identifier">aZipFileName</span>, &amp;<span class="ruby-identifier">block</span>)
  <span class="ruby-identifier">open</span>(<span class="ruby-identifier">aZipFileName</span>) <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">zipFile</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">zipFile</span>.<span class="ruby-identifier">each</span>(&amp;<span class="ruby-identifier">block</span>)
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- foreach-source -->
            
          </div>

          

          
        </div><!-- foreach-method -->

      
        <div id="get_partial_zip_file_name-method" class="method-detail ">
          <a name="method-c-get_partial_zip_file_name"></a>

          
          <div class="method-heading">
            <span class="method-name">get_partial_zip_file_name</span><span
              class="method-args">(zip_file_name, partial_zip_file_name)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            
            

            
            <div class="method-source-code" id="get_partial_zip_file_name-source">
<pre>
<span class="ruby-comment"># File lib/zip/file.rb, line 154</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">get_partial_zip_file_name</span>(<span class="ruby-identifier">zip_file_name</span>, <span class="ruby-identifier">partial_zip_file_name</span>)
  <span class="ruby-identifier">partial_zip_file_name</span> = <span class="ruby-identifier">zip_file_name</span>.<span class="ruby-identifier">sub</span>(<span class="ruby-node">/#{::File.basename(zip_file_name)}\z/</span>,
                                            <span class="ruby-identifier">partial_zip_file_name</span> <span class="ruby-operator">+</span> <span class="ruby-operator">::</span><span class="ruby-constant">File</span>.<span class="ruby-identifier">extname</span>(<span class="ruby-identifier">zip_file_name</span>)) <span class="ruby-keyword">unless</span> <span class="ruby-identifier">partial_zip_file_name</span>.<span class="ruby-identifier">nil?</span>
  <span class="ruby-identifier">partial_zip_file_name</span> <span class="ruby-operator">||=</span> <span class="ruby-identifier">zip_file_name</span>
  <span class="ruby-identifier">partial_zip_file_name</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- get_partial_zip_file_name-source -->
            
          </div>

          

          
        </div><!-- get_partial_zip_file_name-method -->

      
        <div id="get_segment_count_for_split-method" class="method-detail ">
          <a name="method-c-get_segment_count_for_split"></a>

          
          <div class="method-heading">
            <span class="method-name">get_segment_count_for_split</span><span
              class="method-args">(zip_file_size, segment_size)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            
            

            
            <div class="method-source-code" id="get_segment_count_for_split-source">
<pre>
<span class="ruby-comment"># File lib/zip/file.rb, line 161</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">get_segment_count_for_split</span>(<span class="ruby-identifier">zip_file_size</span>, <span class="ruby-identifier">segment_size</span>)
  (<span class="ruby-identifier">zip_file_size</span> <span class="ruby-operator">/</span> <span class="ruby-identifier">segment_size</span>).<span class="ruby-identifier">to_i</span> <span class="ruby-operator">+</span> (<span class="ruby-identifier">zip_file_size</span> <span class="ruby-operator">%</span> <span class="ruby-identifier">segment_size</span> <span class="ruby-operator">==</span> <span class="ruby-value">0</span> <span class="ruby-operator">?</span> <span class="ruby-value">0</span> <span class="ruby-operator">:</span> <span class="ruby-value">1</span>)
<span class="ruby-keyword">end</span></pre>
            </div><!-- get_segment_count_for_split-source -->
            
          </div>

          

          
        </div><!-- get_segment_count_for_split-method -->

      
        <div id="get_segment_size_for_split-method" class="method-detail ">
          <a name="method-c-get_segment_size_for_split"></a>

          
          <div class="method-heading">
            <span class="method-name">get_segment_size_for_split</span><span
              class="method-args">(segment_size)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            
            

            
            <div class="method-source-code" id="get_segment_size_for_split-source">
<pre>
<span class="ruby-comment"># File lib/zip/file.rb, line 143</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">get_segment_size_for_split</span>(<span class="ruby-identifier">segment_size</span>)
  <span class="ruby-keyword">case</span>
  <span class="ruby-keyword">when</span> <span class="ruby-constant">MIN_SEGMENT_SIZE</span> <span class="ruby-operator">&gt;</span> <span class="ruby-identifier">segment_size</span>
    <span class="ruby-constant">MIN_SEGMENT_SIZE</span>
  <span class="ruby-keyword">when</span> <span class="ruby-constant">MAX_SEGMENT_SIZE</span> <span class="ruby-operator">&lt;</span> <span class="ruby-identifier">segment_size</span>
    <span class="ruby-constant">MAX_SEGMENT_SIZE</span>
  <span class="ruby-keyword">else</span>
    <span class="ruby-identifier">segment_size</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- get_segment_size_for_split-source -->
            
          </div>

          

          
        </div><!-- get_segment_size_for_split-method -->

      
        <div id="new-method" class="method-detail ">
          <a name="method-c-new"></a>

          
          <div class="method-heading">
            <span class="method-name">new</span><span
              class="method-args">(file_name, create = nil, buffer = false, options = {})</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Opens a zip archive. Pass true as the second parameter to create a new
archive if it doesn't exist already.</p>
            

            
            <div class="method-source-code" id="new-source">
<pre>
<span class="ruby-comment"># File lib/zip/file.rb, line 67</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">initialize</span>(<span class="ruby-identifier">file_name</span>, <span class="ruby-identifier">create</span> = <span class="ruby-keyword">nil</span>, <span class="ruby-identifier">buffer</span> = <span class="ruby-keyword">false</span>, <span class="ruby-identifier">options</span> = {})
  <span class="ruby-keyword">super</span>()
  <span class="ruby-ivar">@name</span>    = <span class="ruby-identifier">file_name</span>
  <span class="ruby-ivar">@comment</span> = <span class="ruby-string">''</span>
  <span class="ruby-ivar">@create</span>  = <span class="ruby-identifier">create</span>
  <span class="ruby-keyword">case</span>
  <span class="ruby-keyword">when</span> <span class="ruby-operator">!</span><span class="ruby-identifier">buffer</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-operator">::</span><span class="ruby-constant">File</span>.<span class="ruby-identifier">size?</span>(<span class="ruby-identifier">file_name</span>)
    <span class="ruby-ivar">@create</span> = <span class="ruby-keyword">nil</span>
    <span class="ruby-ivar">@exist_file_perms</span> = <span class="ruby-operator">::</span><span class="ruby-constant">File</span>.<span class="ruby-identifier">stat</span>(<span class="ruby-identifier">file_name</span>).<span class="ruby-identifier">mode</span>
    <span class="ruby-operator">::</span><span class="ruby-constant">File</span>.<span class="ruby-identifier">open</span>(<span class="ruby-identifier">name</span>, <span class="ruby-string">'rb'</span>) <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">f</span><span class="ruby-operator">|</span>
      <span class="ruby-identifier">read_from_stream</span>(<span class="ruby-identifier">f</span>)
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">when</span> <span class="ruby-identifier">create</span>
    <span class="ruby-ivar">@entry_set</span> = <span class="ruby-constant">EntrySet</span>.<span class="ruby-identifier">new</span>
  <span class="ruby-keyword">else</span>
    <span class="ruby-identifier">raise</span> <span class="ruby-constant">Error</span>, <span class="ruby-node">&quot;File #{file_name} not found&quot;</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-ivar">@stored_entries</span>      = <span class="ruby-ivar">@entry_set</span>.<span class="ruby-identifier">dup</span>
  <span class="ruby-ivar">@stored_comment</span>      = <span class="ruby-ivar">@comment</span>
  <span class="ruby-ivar">@restore_ownership</span>   = <span class="ruby-identifier">options</span>[<span class="ruby-value">:restore_ownership</span>]    <span class="ruby-operator">||</span> <span class="ruby-keyword">false</span>
  <span class="ruby-ivar">@restore_permissions</span> = <span class="ruby-identifier">options</span>[<span class="ruby-value">:restore_permissions</span>]  <span class="ruby-operator">||</span> <span class="ruby-keyword">true</span>
  <span class="ruby-ivar">@restore_times</span>       = <span class="ruby-identifier">options</span>[<span class="ruby-value">:restore_times</span>]        <span class="ruby-operator">||</span> <span class="ruby-keyword">true</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- new-source -->
            
          </div>

          

          
        </div><!-- new-method -->

      
        <div id="open-method" class="method-detail ">
          <a name="method-c-open"></a>

          
          <div class="method-heading">
            <span class="method-name">open</span><span
              class="method-args">(file_name, create = nil)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Same as new. If a block is passed the ZipFile object is passed to the block
and is automatically closed afterwards just as with ruby's builtin <a
href="File.html#method-c-open">File.open</a> method.</p>
            

            
            <div class="method-source-code" id="open-source">
<pre>
<span class="ruby-comment"># File lib/zip/file.rb, line 95</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">open</span>(<span class="ruby-identifier">file_name</span>, <span class="ruby-identifier">create</span> = <span class="ruby-keyword">nil</span>)
  <span class="ruby-identifier">zf</span> = <span class="ruby-operator">::</span><span class="ruby-constant">Zip</span><span class="ruby-operator">::</span><span class="ruby-constant">File</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">file_name</span>, <span class="ruby-identifier">create</span>)
  <span class="ruby-keyword">return</span> <span class="ruby-identifier">zf</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">block_given?</span>
  <span class="ruby-keyword">begin</span>
    <span class="ruby-keyword">yield</span> <span class="ruby-identifier">zf</span>
  <span class="ruby-keyword">ensure</span>
    <span class="ruby-identifier">zf</span>.<span class="ruby-identifier">close</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- open-source -->
            
          </div>

          

          
        </div><!-- open-method -->

      
        <div id="open_buffer-method" class="method-detail ">
          <a name="method-c-open_buffer"></a>

          
          <div class="method-heading">
            <span class="method-name">open_buffer</span><span
              class="method-args">(io, options = {})</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Like open, but reads zip archive contents from a String or open IO stream,
and outputs data to a buffer. (This can be used to extract data from a
downloaded zip archive without first saving it to disk.)</p>
            

            
            <div class="method-source-code" id="open_buffer-source">
<pre>
<span class="ruby-comment"># File lib/zip/file.rb, line 117</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">open_buffer</span>(<span class="ruby-identifier">io</span>, <span class="ruby-identifier">options</span> = {})
  <span class="ruby-keyword">unless</span> <span class="ruby-identifier">io</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">IO</span>) <span class="ruby-operator">||</span> <span class="ruby-identifier">io</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">String</span>) <span class="ruby-operator">||</span> <span class="ruby-identifier">io</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Tempfile</span>)
    <span class="ruby-identifier">raise</span> <span class="ruby-node">&quot;Zip::File.open_buffer expects an argument of class String, IO, or Tempfile. Found: #{io.class}&quot;</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">io</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-operator">::</span><span class="ruby-constant">String</span>)
    <span class="ruby-identifier">require</span> <span class="ruby-string">'stringio'</span>
    <span class="ruby-identifier">io</span> = <span class="ruby-operator">::</span><span class="ruby-constant">StringIO</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">io</span>)
  <span class="ruby-keyword">end</span>
  <span class="ruby-identifier">zf</span> = <span class="ruby-operator">::</span><span class="ruby-constant">Zip</span><span class="ruby-operator">::</span><span class="ruby-constant">File</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">io</span>, <span class="ruby-keyword">true</span>, <span class="ruby-keyword">true</span>, <span class="ruby-identifier">options</span>)
  <span class="ruby-identifier">zf</span>.<span class="ruby-identifier">read_from_stream</span>(<span class="ruby-identifier">io</span>)
  <span class="ruby-keyword">yield</span> <span class="ruby-identifier">zf</span>
  <span class="ruby-identifier">zf</span>.<span class="ruby-identifier">write_buffer</span>(<span class="ruby-identifier">io</span>)
<span class="ruby-keyword">end</span></pre>
            </div><!-- open_buffer-source -->
            
          </div>

          

          
        </div><!-- open_buffer-method -->

      
        <div id="put_split_signature-method" class="method-detail ">
          <a name="method-c-put_split_signature"></a>

          
          <div class="method-heading">
            <span class="method-name">put_split_signature</span><span
              class="method-args">(szip_file, segment_size)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            
            

            
            <div class="method-source-code" id="put_split_signature-source">
<pre>
<span class="ruby-comment"># File lib/zip/file.rb, line 165</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">put_split_signature</span>(<span class="ruby-identifier">szip_file</span>, <span class="ruby-identifier">segment_size</span>)
  <span class="ruby-identifier">signature_packed</span> = [<span class="ruby-constant">SPLIT_SIGNATURE</span>].<span class="ruby-identifier">pack</span>(<span class="ruby-string">'V'</span>)
  <span class="ruby-identifier">szip_file</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">signature_packed</span>
  <span class="ruby-identifier">segment_size</span> <span class="ruby-operator">-</span> <span class="ruby-identifier">signature_packed</span>.<span class="ruby-identifier">size</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- put_split_signature-source -->
            
          </div>

          

          
        </div><!-- put_split_signature-method -->

      
        <div id="save_splited_part-method" class="method-detail ">
          <a name="method-c-save_splited_part"></a>

          
          <div class="method-heading">
            <span class="method-name">save_splited_part</span><span
              class="method-args">(zip_file, partial_zip_file_name, zip_file_size, szip_file_index, segment_size, segment_count)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>TODO: Make the code more understandable</p>
            

            
            <div class="method-source-code" id="save_splited_part-source">
<pre>
<span class="ruby-comment"># File lib/zip/file.rb, line 174</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">save_splited_part</span>(<span class="ruby-identifier">zip_file</span>, <span class="ruby-identifier">partial_zip_file_name</span>, <span class="ruby-identifier">zip_file_size</span>, <span class="ruby-identifier">szip_file_index</span>, <span class="ruby-identifier">segment_size</span>, <span class="ruby-identifier">segment_count</span>)
  <span class="ruby-identifier">ssegment_size</span>  = <span class="ruby-identifier">zip_file_size</span> <span class="ruby-operator">-</span> <span class="ruby-identifier">zip_file</span>.<span class="ruby-identifier">pos</span>
  <span class="ruby-identifier">ssegment_size</span>  = <span class="ruby-identifier">segment_size</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">ssegment_size</span> <span class="ruby-operator">&gt;</span> <span class="ruby-identifier">segment_size</span>
  <span class="ruby-identifier">szip_file_name</span> = <span class="ruby-node">&quot;#{partial_zip_file_name}.#{'%03d'%(szip_file_index)}&quot;</span>
  <span class="ruby-operator">::</span><span class="ruby-constant">File</span>.<span class="ruby-identifier">open</span>(<span class="ruby-identifier">szip_file_name</span>, <span class="ruby-string">'wb'</span>) <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">szip_file</span><span class="ruby-operator">|</span>
    <span class="ruby-keyword">if</span> <span class="ruby-identifier">szip_file_index</span> <span class="ruby-operator">==</span> <span class="ruby-value">1</span>
      <span class="ruby-identifier">ssegment_size</span> = <span class="ruby-identifier">put_split_signature</span>(<span class="ruby-identifier">szip_file</span>, <span class="ruby-identifier">segment_size</span>)
    <span class="ruby-keyword">end</span>
    <span class="ruby-identifier">chunk_bytes</span> = <span class="ruby-value">0</span>
    <span class="ruby-keyword">until</span> <span class="ruby-identifier">ssegment_size</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">chunk_bytes</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">zip_file</span>.<span class="ruby-identifier">eof?</span>
      <span class="ruby-identifier">segment_bytes_left</span> = <span class="ruby-identifier">ssegment_size</span> <span class="ruby-operator">-</span> <span class="ruby-identifier">chunk_bytes</span>
      <span class="ruby-identifier">buffer_size</span>        = <span class="ruby-identifier">segment_bytes_left</span> <span class="ruby-operator">&lt;</span> <span class="ruby-constant">DATA_BUFFER_SIZE</span> <span class="ruby-operator">?</span> <span class="ruby-identifier">segment_bytes_left</span> <span class="ruby-operator">:</span> <span class="ruby-constant">DATA_BUFFER_SIZE</span>
      <span class="ruby-identifier">chunk</span>              = <span class="ruby-identifier">zip_file</span>.<span class="ruby-identifier">read</span>(<span class="ruby-identifier">buffer_size</span>)
      <span class="ruby-identifier">chunk_bytes</span>        <span class="ruby-operator">+=</span> <span class="ruby-identifier">buffer_size</span>
      <span class="ruby-identifier">szip_file</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">chunk</span>
      <span class="ruby-comment"># Info for track splitting</span>
      <span class="ruby-keyword">yield</span> <span class="ruby-identifier">segment_count</span>, <span class="ruby-identifier">szip_file_index</span>, <span class="ruby-identifier">chunk_bytes</span>, <span class="ruby-identifier">ssegment_size</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">block_given?</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- save_splited_part-source -->
            
          </div>

          

          
        </div><!-- save_splited_part-method -->

      
        <div id="split-method" class="method-detail ">
          <a name="method-c-split"></a>

          
          <div class="method-heading">
            <span class="method-name">split</span><span
              class="method-args">(zip_file_name, segment_size = MAX_SEGMENT_SIZE, delete_zip_file = true, partial_zip_file_name = nil)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Splits an archive into parts with segment size</p>
            

            
            <div class="method-source-code" id="split-source">
<pre>
<span class="ruby-comment"># File lib/zip/file.rb, line 196</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">split</span>(<span class="ruby-identifier">zip_file_name</span>, <span class="ruby-identifier">segment_size</span> = <span class="ruby-constant">MAX_SEGMENT_SIZE</span>, <span class="ruby-identifier">delete_zip_file</span> = <span class="ruby-keyword">true</span>, <span class="ruby-identifier">partial_zip_file_name</span> = <span class="ruby-keyword">nil</span>)
  <span class="ruby-identifier">raise</span> <span class="ruby-constant">Error</span>, <span class="ruby-node">&quot;File #{zip_file_name} not found&quot;</span> <span class="ruby-keyword">unless</span> <span class="ruby-operator">::</span><span class="ruby-constant">File</span>.<span class="ruby-identifier">exist?</span>(<span class="ruby-identifier">zip_file_name</span>)
  <span class="ruby-identifier">raise</span> <span class="ruby-constant">Errno</span><span class="ruby-operator">::</span><span class="ruby-constant">ENOENT</span>, <span class="ruby-identifier">zip_file_name</span> <span class="ruby-keyword">unless</span> <span class="ruby-operator">::</span><span class="ruby-constant">File</span>.<span class="ruby-identifier">readable?</span>(<span class="ruby-identifier">zip_file_name</span>)
  <span class="ruby-identifier">zip_file_size</span> = <span class="ruby-operator">::</span><span class="ruby-constant">File</span>.<span class="ruby-identifier">size</span>(<span class="ruby-identifier">zip_file_name</span>)
  <span class="ruby-identifier">segment_size</span>  = <span class="ruby-identifier">get_segment_size_for_split</span>(<span class="ruby-identifier">segment_size</span>)
  <span class="ruby-keyword">return</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">zip_file_size</span> <span class="ruby-operator">&lt;=</span> <span class="ruby-identifier">segment_size</span>
  <span class="ruby-identifier">segment_count</span> = <span class="ruby-identifier">get_segment_count_for_split</span>(<span class="ruby-identifier">zip_file_size</span>, <span class="ruby-identifier">segment_size</span>)
  <span class="ruby-comment"># Checking for correct zip structure</span>
  <span class="ruby-keyword">self</span>.<span class="ruby-identifier">open</span>(<span class="ruby-identifier">zip_file_name</span>) {}
  <span class="ruby-identifier">partial_zip_file_name</span> = <span class="ruby-identifier">get_partial_zip_file_name</span>(<span class="ruby-identifier">zip_file_name</span>, <span class="ruby-identifier">partial_zip_file_name</span>)
  <span class="ruby-identifier">szip_file_index</span>       = <span class="ruby-value">0</span>
  <span class="ruby-operator">::</span><span class="ruby-constant">File</span>.<span class="ruby-identifier">open</span>(<span class="ruby-identifier">zip_file_name</span>, <span class="ruby-string">'rb'</span>) <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">zip_file</span><span class="ruby-operator">|</span>
    <span class="ruby-keyword">until</span> <span class="ruby-identifier">zip_file</span>.<span class="ruby-identifier">eof?</span>
      <span class="ruby-identifier">szip_file_index</span> <span class="ruby-operator">+=</span> <span class="ruby-value">1</span>
      <span class="ruby-identifier">save_splited_part</span>(<span class="ruby-identifier">zip_file</span>, <span class="ruby-identifier">partial_zip_file_name</span>, <span class="ruby-identifier">zip_file_size</span>, <span class="ruby-identifier">szip_file_index</span>, <span class="ruby-identifier">segment_size</span>, <span class="ruby-identifier">segment_count</span>)
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-operator">::</span><span class="ruby-constant">File</span>.<span class="ruby-identifier">delete</span>(<span class="ruby-identifier">zip_file_name</span>) <span class="ruby-keyword">if</span> <span class="ruby-identifier">delete_zip_file</span>
  <span class="ruby-identifier">szip_file_index</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- split-source -->
            
          </div>

          

          
        </div><!-- split-method -->

      
      </div><!-- public-class-method-details -->
    
      <div id="public-instance-method-details" class="method-section section">
        <h3 class="section-header">Public Instance Methods</h3>

      
        <div id="add-method" class="method-detail ">
          <a name="method-i-add"></a>

          
          <div class="method-heading">
            <span class="method-name">add</span><span
              class="method-args">(entry, src_path, &continue_on_exists_proc)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Convenience method for adding the contents of a file to the archive</p>
            

            
            <div class="method-source-code" id="add-source">
<pre>
<span class="ruby-comment"># File lib/zip/file.rb, line 259</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">add</span>(<span class="ruby-identifier">entry</span>, <span class="ruby-identifier">src_path</span>, &amp;<span class="ruby-identifier">continue_on_exists_proc</span>)
  <span class="ruby-identifier">continue_on_exists_proc</span> <span class="ruby-operator">||=</span> <span class="ruby-identifier">proc</span> { <span class="ruby-operator">::</span><span class="ruby-constant">Zip</span>.<span class="ruby-identifier">continue_on_exists_proc</span> }
  <span class="ruby-identifier">check_entry_exists</span>(<span class="ruby-identifier">entry</span>, <span class="ruby-identifier">continue_on_exists_proc</span>, <span class="ruby-string">&quot;add&quot;</span>)
  <span class="ruby-identifier">new_entry</span> = <span class="ruby-identifier">entry</span>.<span class="ruby-identifier">kind_of?</span>(<span class="ruby-operator">::</span><span class="ruby-constant">Zip</span><span class="ruby-operator">::</span><span class="ruby-constant">Entry</span>) <span class="ruby-operator">?</span> <span class="ruby-identifier">entry</span> <span class="ruby-operator">:</span> <span class="ruby-operator">::</span><span class="ruby-constant">Zip</span><span class="ruby-operator">::</span><span class="ruby-constant">Entry</span>.<span class="ruby-identifier">new</span>(<span class="ruby-ivar">@name</span>, <span class="ruby-identifier">entry</span>.<span class="ruby-identifier">to_s</span>)
  <span class="ruby-identifier">new_entry</span>.<span class="ruby-identifier">gather_fileinfo_from_srcpath</span>(<span class="ruby-identifier">src_path</span>)
  <span class="ruby-identifier">new_entry</span>.<span class="ruby-identifier">dirty</span> = <span class="ruby-keyword">true</span>
  <span class="ruby-ivar">@entry_set</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">new_entry</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- add-source -->
            
          </div>

          

          
        </div><!-- add-method -->

      
        <div id="close-method" class="method-detail ">
          <a name="method-i-close"></a>

          
          <div class="method-heading">
            <span class="method-name">close</span><span
              class="method-args">()</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Closes the zip file committing any changes that has been made.</p>
            

            
            <div class="method-source-code" id="close-source">
<pre>
<span class="ruby-comment"># File lib/zip/file.rb, line 324</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">close</span>
  <span class="ruby-identifier">commit</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- close-source -->
            
          </div>

          

          
        </div><!-- close-method -->

      
        <div id="commit-method" class="method-detail ">
          <a name="method-i-commit"></a>

          
          <div class="method-heading">
            <span class="method-name">commit</span><span
              class="method-args">()</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Commits changes that has been made since the previous commit to the zip
archive.</p>
            

            
            <div class="method-source-code" id="commit-source">
<pre>
<span class="ruby-comment"># File lib/zip/file.rb, line 299</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">commit</span>
  <span class="ruby-keyword">return</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">commit_required?</span>
  <span class="ruby-identifier">on_success_replace</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">tmp_file</span><span class="ruby-operator">|</span>
    <span class="ruby-operator">::</span><span class="ruby-constant">Zip</span><span class="ruby-operator">::</span><span class="ruby-constant">OutputStream</span>.<span class="ruby-identifier">open</span>(<span class="ruby-identifier">tmp_file</span>) <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">zos</span><span class="ruby-operator">|</span>
      <span class="ruby-ivar">@entry_set</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">e</span><span class="ruby-operator">|</span>
        <span class="ruby-identifier">e</span>.<span class="ruby-identifier">write_to_zip_output_stream</span>(<span class="ruby-identifier">zos</span>)
        <span class="ruby-identifier">e</span>.<span class="ruby-identifier">dirty</span> = <span class="ruby-keyword">false</span>
        <span class="ruby-identifier">e</span>.<span class="ruby-identifier">clean_up</span>
      <span class="ruby-keyword">end</span>
      <span class="ruby-identifier">zos</span>.<span class="ruby-identifier">comment</span> = <span class="ruby-identifier">comment</span>
    <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">true</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-identifier">initialize</span>(<span class="ruby-identifier">name</span>)
<span class="ruby-keyword">end</span></pre>
            </div><!-- commit-source -->
            
          </div>

          

          
        </div><!-- commit-method -->

      
        <div id="commit_required-3F-method" class="method-detail ">
          <a name="method-i-commit_required-3F"></a>

          
          <div class="method-heading">
            <span class="method-name">commit_required?</span><span
              class="method-args">()</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Returns true if any changes has been made to this archive since the
previous commit</p>
            

            
            <div class="method-source-code" id="commit_required-3F-source">
<pre>
<span class="ruby-comment"># File lib/zip/file.rb, line 330</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">commit_required?</span>
  <span class="ruby-ivar">@entry_set</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">e</span><span class="ruby-operator">|</span>
    <span class="ruby-keyword">return</span> <span class="ruby-keyword">true</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">e</span>.<span class="ruby-identifier">dirty</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-ivar">@comment</span> <span class="ruby-operator">!=</span> <span class="ruby-ivar">@stored_comment</span> <span class="ruby-operator">||</span> <span class="ruby-ivar">@entry_set</span> <span class="ruby-operator">!=</span> <span class="ruby-ivar">@stored_entries</span> <span class="ruby-operator">||</span> <span class="ruby-ivar">@create</span> <span class="ruby-operator">==</span> <span class="ruby-operator">::</span><span class="ruby-constant">Zip</span><span class="ruby-operator">::</span><span class="ruby-constant">File</span><span class="ruby-operator">::</span><span class="ruby-constant">CREATE</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- commit_required-3F-source -->
            
          </div>

          

          
        </div><!-- commit_required-3F-method -->

      
        <div id="extract-method" class="method-detail ">
          <a name="method-i-extract"></a>

          
          <div class="method-heading">
            <span class="method-name">extract</span><span
              class="method-args">(entry, dest_path, &block)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Extracts entry to file dest_path.</p>
            

            
            <div class="method-source-code" id="extract-source">
<pre>
<span class="ruby-comment"># File lib/zip/file.rb, line 291</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">extract</span>(<span class="ruby-identifier">entry</span>, <span class="ruby-identifier">dest_path</span>, &amp;<span class="ruby-identifier">block</span>)
  <span class="ruby-identifier">block</span> <span class="ruby-operator">||=</span> <span class="ruby-identifier">proc</span> { <span class="ruby-operator">::</span><span class="ruby-constant">Zip</span>.<span class="ruby-identifier">on_exists_proc</span> }
  <span class="ruby-identifier">found_entry</span> = <span class="ruby-identifier">get_entry</span>(<span class="ruby-identifier">entry</span>)
  <span class="ruby-identifier">found_entry</span>.<span class="ruby-identifier">extract</span>(<span class="ruby-identifier">dest_path</span>, &amp;<span class="ruby-identifier">block</span>)
<span class="ruby-keyword">end</span></pre>
            </div><!-- extract-source -->
            
          </div>

          

          
        </div><!-- extract-method -->

      
        <div id="find_entry-method" class="method-detail ">
          <a name="method-i-find_entry"></a>

          
          <div class="method-heading">
            <span class="method-name">find_entry</span><span
              class="method-args">(entry_name)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Searches for entry with the specified name. Returns nil if no entry is
found. See also <a href="File.html#method-i-get_entry">get_entry</a></p>
            

            
            <div class="method-source-code" id="find_entry-source">
<pre>
<span class="ruby-comment"># File lib/zip/file.rb, line 339</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">find_entry</span>(<span class="ruby-identifier">entry_name</span>)
  <span class="ruby-ivar">@entry_set</span>.<span class="ruby-identifier">find_entry</span>(<span class="ruby-identifier">entry_name</span>)
<span class="ruby-keyword">end</span></pre>
            </div><!-- find_entry-source -->
            
          </div>

          

          
        </div><!-- find_entry-method -->

      
        <div id="get_entry-method" class="method-detail ">
          <a name="method-i-get_entry"></a>

          
          <div class="method-heading">
            <span class="method-name">get_entry</span><span
              class="method-args">(entry)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Searches for an entry just as <a
href="File.html#method-i-find_entry">find_entry</a>, but throws
Errno::ENOENT if no entry is found.</p>
            

            
            <div class="method-source-code" id="get_entry-source">
<pre>
<span class="ruby-comment"># File lib/zip/file.rb, line 350</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">get_entry</span>(<span class="ruby-identifier">entry</span>)
  <span class="ruby-identifier">selected_entry</span> = <span class="ruby-identifier">find_entry</span>(<span class="ruby-identifier">entry</span>)
  <span class="ruby-keyword">unless</span> <span class="ruby-identifier">selected_entry</span>
    <span class="ruby-identifier">raise</span> <span class="ruby-constant">Errno</span><span class="ruby-operator">::</span><span class="ruby-constant">ENOENT</span>, <span class="ruby-identifier">entry</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-identifier">selected_entry</span>.<span class="ruby-identifier">restore_ownership</span>   = <span class="ruby-ivar">@restore_ownership</span>
  <span class="ruby-identifier">selected_entry</span>.<span class="ruby-identifier">restore_permissions</span> = <span class="ruby-ivar">@restore_permissions</span>
  <span class="ruby-identifier">selected_entry</span>.<span class="ruby-identifier">restore_times</span>       = <span class="ruby-ivar">@restore_times</span>
  <span class="ruby-identifier">selected_entry</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- get_entry-source -->
            
          </div>

          

          
        </div><!-- get_entry-method -->

      
        <div id="get_input_stream-method" class="method-detail ">
          <a name="method-i-get_input_stream"></a>

          
          <div class="method-heading">
            <span class="method-name">get_input_stream</span><span
              class="method-args">(entry, &aProc)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Returns an input stream to the specified entry. If a block is passed the
stream object is passed to the block and the stream is automatically closed
afterwards just as with ruby's builtin <a
href="File.html#method-c-open">File.open</a> method.</p>
            

            
            <div class="method-source-code" id="get_input_stream-source">
<pre>
<span class="ruby-comment"># File lib/zip/file.rb, line 222</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">get_input_stream</span>(<span class="ruby-identifier">entry</span>, &amp;<span class="ruby-identifier">aProc</span>)
  <span class="ruby-identifier">get_entry</span>(<span class="ruby-identifier">entry</span>).<span class="ruby-identifier">get_input_stream</span>(&amp;<span class="ruby-identifier">aProc</span>)
<span class="ruby-keyword">end</span></pre>
            </div><!-- get_input_stream-source -->
            
          </div>

          

          
        </div><!-- get_input_stream-method -->

      
        <div id="get_output_stream-method" class="method-detail ">
          <a name="method-i-get_output_stream"></a>

          
          <div class="method-heading">
            <span class="method-name">get_output_stream</span><span
              class="method-args">(entry, permission_int = nil, comment = nil, extra = nil, compressed_size = nil, crc = nil, compression_method = nil, size = nil, time = nil, &aProc)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Returns an output stream to the specified entry. If entry is not an
instance of <a href="Entry.html">Zip::Entry</a>, a new <a
href="Entry.html">Zip::Entry</a> will be initialized using the arguments
specified. If a block is passed the stream object is passed to the block
and the stream is automatically closed afterwards just as with ruby's
builtin <a href="File.html#method-c-open">File.open</a> method.</p>
            

            
            <div class="method-source-code" id="get_output_stream-source">
<pre>
<span class="ruby-comment"># File lib/zip/file.rb, line 231</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">get_output_stream</span>(<span class="ruby-identifier">entry</span>, <span class="ruby-identifier">permission_int</span> = <span class="ruby-keyword">nil</span>, <span class="ruby-identifier">comment</span> = <span class="ruby-keyword">nil</span>, <span class="ruby-identifier">extra</span> = <span class="ruby-keyword">nil</span>, <span class="ruby-identifier">compressed_size</span> = <span class="ruby-keyword">nil</span>, <span class="ruby-identifier">crc</span> = <span class="ruby-keyword">nil</span>, <span class="ruby-identifier">compression_method</span> = <span class="ruby-keyword">nil</span>, <span class="ruby-identifier">size</span> = <span class="ruby-keyword">nil</span>, <span class="ruby-identifier">time</span> = <span class="ruby-keyword">nil</span>,  &amp;<span class="ruby-identifier">aProc</span>)
  <span class="ruby-identifier">new_entry</span> =
    <span class="ruby-keyword">if</span> <span class="ruby-identifier">entry</span>.<span class="ruby-identifier">kind_of?</span>(<span class="ruby-constant">Entry</span>)
      <span class="ruby-identifier">entry</span>
    <span class="ruby-keyword">else</span>
      <span class="ruby-constant">Entry</span>.<span class="ruby-identifier">new</span>(<span class="ruby-ivar">@name</span>, <span class="ruby-identifier">entry</span>.<span class="ruby-identifier">to_s</span>, <span class="ruby-identifier">comment</span>, <span class="ruby-identifier">extra</span>, <span class="ruby-identifier">compressed_size</span>, <span class="ruby-identifier">crc</span>, <span class="ruby-identifier">compression_method</span>, <span class="ruby-identifier">size</span>, <span class="ruby-identifier">time</span>)
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">new_entry</span>.<span class="ruby-identifier">directory?</span>
    <span class="ruby-identifier">raise</span> <span class="ruby-constant">ArgumentError</span>,
          <span class="ruby-node">&quot;cannot open stream to directory entry - '#{new_entry}'&quot;</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-identifier">new_entry</span>.<span class="ruby-identifier">unix_perms</span> = <span class="ruby-identifier">permission_int</span>
  <span class="ruby-identifier">zip_streamable_entry</span> = <span class="ruby-constant">StreamableStream</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">new_entry</span>)
  <span class="ruby-ivar">@entry_set</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">zip_streamable_entry</span>
  <span class="ruby-identifier">zip_streamable_entry</span>.<span class="ruby-identifier">get_output_stream</span>(&amp;<span class="ruby-identifier">aProc</span>)
<span class="ruby-keyword">end</span></pre>
            </div><!-- get_output_stream-source -->
            
          </div>

          

          
        </div><!-- get_output_stream-method -->

      
        <div id="glob-method" class="method-detail ">
          <a name="method-i-glob"></a>

          
          <div class="method-heading">
            <span class="method-name">glob</span><span
              class="method-args">(*args, &block)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Searches for entries given a glob</p>
            

            
            <div class="method-source-code" id="glob-source">
<pre>
<span class="ruby-comment"># File lib/zip/file.rb, line 344</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">glob</span>(*<span class="ruby-identifier">args</span>, &amp;<span class="ruby-identifier">block</span>)
  <span class="ruby-ivar">@entry_set</span>.<span class="ruby-identifier">glob</span>(*<span class="ruby-identifier">args</span>, &amp;<span class="ruby-identifier">block</span>)
<span class="ruby-keyword">end</span></pre>
            </div><!-- glob-source -->
            
          </div>

          

          
        </div><!-- glob-method -->

      
        <div id="mkdir-method" class="method-detail ">
          <a name="method-i-mkdir"></a>

          
          <div class="method-heading">
            <span class="method-name">mkdir</span><span
              class="method-args">(entryName, permissionInt = 0755)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Creates a directory</p>
            

            
            <div class="method-source-code" id="mkdir-source">
<pre>
<span class="ruby-comment"># File lib/zip/file.rb, line 362</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">mkdir</span>(<span class="ruby-identifier">entryName</span>, <span class="ruby-identifier">permissionInt</span> = <span class="ruby-value">0755</span>)
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">find_entry</span>(<span class="ruby-identifier">entryName</span>)
    <span class="ruby-identifier">raise</span> <span class="ruby-constant">Errno</span><span class="ruby-operator">::</span><span class="ruby-constant">EEXIST</span>, <span class="ruby-node">&quot;File exists - #{entryName}&quot;</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-identifier">entryName</span> = <span class="ruby-identifier">entryName</span>.<span class="ruby-identifier">dup</span>.<span class="ruby-identifier">to_s</span>
  <span class="ruby-identifier">entryName</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-string">'/'</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">entryName</span>.<span class="ruby-identifier">end_with?</span>(<span class="ruby-string">'/'</span>)
  <span class="ruby-ivar">@entry_set</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-operator">::</span><span class="ruby-constant">Zip</span><span class="ruby-operator">::</span><span class="ruby-constant">StreamableDirectory</span>.<span class="ruby-identifier">new</span>(<span class="ruby-ivar">@name</span>, <span class="ruby-identifier">entryName</span>, <span class="ruby-keyword">nil</span>, <span class="ruby-identifier">permissionInt</span>)
<span class="ruby-keyword">end</span></pre>
            </div><!-- mkdir-source -->
            
          </div>

          

          
        </div><!-- mkdir-method -->

      
        <div id="read-method" class="method-detail ">
          <a name="method-i-read"></a>

          
          <div class="method-heading">
            <span class="method-name">read</span><span
              class="method-args">(entry)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Returns a string containing the contents of the specified entry</p>
            

            
            <div class="method-source-code" id="read-source">
<pre>
<span class="ruby-comment"># File lib/zip/file.rb, line 254</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">read</span>(<span class="ruby-identifier">entry</span>)
  <span class="ruby-identifier">get_input_stream</span>(<span class="ruby-identifier">entry</span>) { <span class="ruby-operator">|</span><span class="ruby-identifier">is</span><span class="ruby-operator">|</span> <span class="ruby-identifier">is</span>.<span class="ruby-identifier">read</span> }
<span class="ruby-keyword">end</span></pre>
            </div><!-- read-source -->
            
          </div>

          

          
        </div><!-- read-method -->

      
        <div id="remove-method" class="method-detail ">
          <a name="method-i-remove"></a>

          
          <div class="method-heading">
            <span class="method-name">remove</span><span
              class="method-args">(entry)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Removes the specified entry.</p>
            

            
            <div class="method-source-code" id="remove-source">
<pre>
<span class="ruby-comment"># File lib/zip/file.rb, line 269</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">remove</span>(<span class="ruby-identifier">entry</span>)
  <span class="ruby-ivar">@entry_set</span>.<span class="ruby-identifier">delete</span>(<span class="ruby-identifier">get_entry</span>(<span class="ruby-identifier">entry</span>))
<span class="ruby-keyword">end</span></pre>
            </div><!-- remove-source -->
            
          </div>

          

          
        </div><!-- remove-method -->

      
        <div id="rename-method" class="method-detail ">
          <a name="method-i-rename"></a>

          
          <div class="method-heading">
            <span class="method-name">rename</span><span
              class="method-args">(entry, new_name, &continue_on_exists_proc)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Renames the specified entry.</p>
            

            
            <div class="method-source-code" id="rename-source">
<pre>
<span class="ruby-comment"># File lib/zip/file.rb, line 274</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">rename</span>(<span class="ruby-identifier">entry</span>, <span class="ruby-identifier">new_name</span>, &amp;<span class="ruby-identifier">continue_on_exists_proc</span>)
  <span class="ruby-identifier">foundEntry</span> = <span class="ruby-identifier">get_entry</span>(<span class="ruby-identifier">entry</span>)
  <span class="ruby-identifier">check_entry_exists</span>(<span class="ruby-identifier">new_name</span>, <span class="ruby-identifier">continue_on_exists_proc</span>, <span class="ruby-string">'rename'</span>)
  <span class="ruby-ivar">@entry_set</span>.<span class="ruby-identifier">delete</span>(<span class="ruby-identifier">foundEntry</span>)
  <span class="ruby-identifier">foundEntry</span>.<span class="ruby-identifier">name</span> = <span class="ruby-identifier">new_name</span>
  <span class="ruby-ivar">@entry_set</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">foundEntry</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- rename-source -->
            
          </div>

          

          
        </div><!-- rename-method -->

      
        <div id="replace-method" class="method-detail ">
          <a name="method-i-replace"></a>

          
          <div class="method-heading">
            <span class="method-name">replace</span><span
              class="method-args">(entry, srcPath)</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Replaces the specified entry with the contents of srcPath (from the file
system).</p>
            

            
            <div class="method-source-code" id="replace-source">
<pre>
<span class="ruby-comment"># File lib/zip/file.rb, line 284</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">replace</span>(<span class="ruby-identifier">entry</span>, <span class="ruby-identifier">srcPath</span>)
  <span class="ruby-identifier">check_file</span>(<span class="ruby-identifier">srcPath</span>)
  <span class="ruby-identifier">remove</span>(<span class="ruby-identifier">entry</span>)
  <span class="ruby-identifier">add</span>(<span class="ruby-identifier">entry</span>, <span class="ruby-identifier">srcPath</span>)
<span class="ruby-keyword">end</span></pre>
            </div><!-- replace-source -->
            
          </div>

          

          
        </div><!-- replace-method -->

      
        <div id="to_s-method" class="method-detail ">
          <a name="method-i-to_s"></a>

          
          <div class="method-heading">
            <span class="method-name">to_s</span><span
              class="method-args">()</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Returns the name of the zip archive</p>
            

            
            <div class="method-source-code" id="to_s-source">
<pre>
<span class="ruby-comment"># File lib/zip/file.rb, line 249</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">to_s</span>
  <span class="ruby-ivar">@name</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- to_s-source -->
            
          </div>

          

          
        </div><!-- to_s-method -->

      
        <div id="write_buffer-method" class="method-detail ">
          <a name="method-i-write_buffer"></a>

          
          <div class="method-heading">
            <span class="method-name">write_buffer</span><span
              class="method-args">(io = ::StringIO.new(''))</span>
            <span class="method-click-advice">click to toggle source</span>
          </div>
          

          <div class="method-description">
            
            <p>Write buffer write changes to buffer and return</p>
            

            
            <div class="method-source-code" id="write_buffer-source">
<pre>
<span class="ruby-comment"># File lib/zip/file.rb, line 316</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">write_buffer</span>(<span class="ruby-identifier">io</span> = <span class="ruby-operator">::</span><span class="ruby-constant">StringIO</span>.<span class="ruby-identifier">new</span>(<span class="ruby-string">''</span>))
  <span class="ruby-operator">::</span><span class="ruby-constant">Zip</span><span class="ruby-operator">::</span><span class="ruby-constant">OutputStream</span>.<span class="ruby-identifier">write_buffer</span>(<span class="ruby-identifier">io</span>) <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">zos</span><span class="ruby-operator">|</span>
    <span class="ruby-ivar">@entry_set</span>.<span class="ruby-identifier">each</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">e</span><span class="ruby-operator">|</span> <span class="ruby-identifier">e</span>.<span class="ruby-identifier">write_to_zip_output_stream</span>(<span class="ruby-identifier">zos</span>) }
    <span class="ruby-identifier">zos</span>.<span class="ruby-identifier">comment</span> = <span class="ruby-identifier">comment</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
            </div><!-- write_buffer-source -->
            
          </div>

          

          
        </div><!-- write_buffer-method -->

      
      </div><!-- public-instance-method-details -->
    
    </div><!-- 5Buntitled-5D -->
  

  </div><!-- documentation -->

  <div id="validator-badges">
    <p><small><a href="http://validator.w3.org/check/referer">[Validate]</a></small></p>
    <p><small>Generated with the <a href="http://deveiate.org/projects/Darkfish-Rdoc/">Darkfish
      Rdoc Generator</a> 2</small>.</p>
  </div>

</body>
</html>

