<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <meta content="text/html; charset=IBM437" http-equiv="Content-Type" />

  <title>File: install-sh [ffi-1.9.3-x86-mingw32 Documentation]</title>

  <link type="text/css" media="screen" href="../../../rdoc.css" rel="stylesheet" />

  <script src="../../../js/jquery.js" type="text/javascript"
    charset="utf-8"></script>
  <script src="../../../js/thickbox-compressed.js" type="text/javascript"
    charset="utf-8"></script>
  <script src="../../../js/quicksearch.js" type="text/javascript"
    charset="utf-8"></script>
  <script src="../../../js/darkfish.js" type="text/javascript"
    charset="utf-8"></script>
</head>

<body class="file">
  <div id="metadata">
    <div id="home-metadata">
      <div id="home-section" class="section">
        <h3 class="section-header">
          <a href="../../../index.html">Home</a>
          <a href="../../../index.html#classes">Classes</a>
          <a href="../../../index.html#methods">Methods</a>
        </h3>
      </div>
    </div>

    <div id="project-metadata">
      
      
      <div id="fileindex-section" class="section project-section">
        <h3 class="section-header">Files</h3>
        <ul>
        
          <li class="file"><a href="../../../ext/ffi_c/libffi/ChangeLog.html">ChangeLog</a></li>
        
          <li class="file"><a href="../../../ext/ffi_c/libffi/LICENSE.html">LICENSE</a></li>
        
          <li class="file"><a href="../../../ext/ffi_c/libffi/README.html">README</a></li>
        
          <li class="file"><a href="../../../ext/ffi_c/libffi/compile.html">compile</a></li>
        
          <li class="file"><a href="../../../ext/ffi_c/libffi/configure.html">configure</a></li>
        
          <li class="file"><a href="../../../ext/ffi_c/libffi/depcomp.html">depcomp</a></li>
        
          <li class="file"><a href="../../../ext/ffi_c/libffi/doc/stamp-vti.html">stamp-vti</a></li>
        
          <li class="file"><a href="../../../ext/ffi_c/libffi/install-sh.html">install-sh</a></li>
        
          <li class="file"><a href="../../../ext/ffi_c/libffi/libtool-version.html">libtool-version</a></li>
        
          <li class="file"><a href="../../../ext/ffi_c/libffi/mdate-sh.html">mdate-sh</a></li>
        
          <li class="file"><a href="../../../ext/ffi_c/libffi/missing.html">missing</a></li>
        
        </ul>
      </div>
      

      <div id="classindex-section" class="section project-section">
        <h3 class="section-header">Class Index
          <span class="search-toggle"><img src="../../../images/find.png"
            height="16" width="16" alt="[+]"
            title="show/hide quicksearch" /></span></h3>
        <form action="#" method="get" accept-charset="utf-8" class="initially-hidden">
        <fieldset>
          <legend>Quicksearch</legend>
          <input type="text" name="quicksearch" value=""
            class="quicksearch-field" />
        </fieldset>
        </form>

        <ul class="link-list">
        
          <li><a href="../../../FFI.html">FFI</a></li>
        
          <li><a href="../../../FFI/AutoPointer.html">FFI::AutoPointer</a></li>
        
          <li><a href="../../../FFI/AutoPointer/CallableReleaser.html">FFI::AutoPointer::CallableReleaser</a></li>
        
          <li><a href="../../../FFI/AutoPointer/DefaultReleaser.html">FFI::AutoPointer::DefaultReleaser</a></li>
        
          <li><a href="../../../FFI/AutoPointer/Releaser.html">FFI::AutoPointer::Releaser</a></li>
        
          <li><a href="../../../FFI/ConstGenerator.html">FFI::ConstGenerator</a></li>
        
          <li><a href="../../../FFI/ConstGenerator/Constant.html">FFI::ConstGenerator::Constant</a></li>
        
          <li><a href="../../../FFI/Enum.html">FFI::Enum</a></li>
        
          <li><a href="../../../FFI/Enums.html">FFI::Enums</a></li>
        
          <li><a href="../../../FFI/Function.html">FFI::Function</a></li>
        
          <li><a href="../../../FFI/FunctionType.html">FFI::FunctionType</a></li>
        
          <li><a href="../../../FFI/Generator.html">FFI::Generator</a></li>
        
          <li><a href="../../../FFI/Generator/Task.html">FFI::Generator::Task</a></li>
        
          <li><a href="../../../FFI/IO.html">FFI::IO</a></li>
        
          <li><a href="../../../FFI/LastError.html">FFI::LastError</a></li>
        
          <li><a href="../../../FFI/Library.html">FFI::Library</a></li>
        
          <li><a href="../../../FFI/ManagedStruct.html">FFI::ManagedStruct</a></li>
        
          <li><a href="../../../FFI/MemoryPointer.html">FFI::MemoryPointer</a></li>
        
          <li><a href="../../../FFI/NativeType.html">FFI::NativeType</a></li>
        
          <li><a href="../../../FFI/NotFoundError.html">FFI::NotFoundError</a></li>
        
          <li><a href="../../../FFI/Platform.html">FFI::Platform</a></li>
        
          <li><a href="../../../FFI/PlatformError.html">FFI::PlatformError</a></li>
        
          <li><a href="../../../FFI/Pointer.html">FFI::Pointer</a></li>
        
          <li><a href="../../../FFI/StrPtrConverter.html">FFI::StrPtrConverter</a></li>
        
          <li><a href="../../../FFI/Struct.html">FFI::Struct</a></li>
        
          <li><a href="../../../FFI/Struct/InlineArray.html">FFI::Struct::InlineArray</a></li>
        
          <li><a href="../../../FFI/Struct/ManagedStructConverter.html">FFI::Struct::ManagedStructConverter</a></li>
        
          <li><a href="../../../FFI/StructByReference.html">FFI::StructByReference</a></li>
        
          <li><a href="../../../FFI/StructByValue.html">FFI::StructByValue</a></li>
        
          <li><a href="../../../FFI/StructGenerator.html">FFI::StructGenerator</a></li>
        
          <li><a href="../../../FFI/StructGenerator/Field.html">FFI::StructGenerator::Field</a></li>
        
          <li><a href="../../../FFI/StructLayout.html">FFI::StructLayout</a></li>
        
          <li><a href="../../../FFI/StructLayout/Array.html">FFI::StructLayout::Array</a></li>
        
          <li><a href="../../../FFI/StructLayout/Enum.html">FFI::StructLayout::Enum</a></li>
        
          <li><a href="../../../FFI/StructLayout/Field.html">FFI::StructLayout::Field</a></li>
        
          <li><a href="../../../FFI/StructLayout/Function.html">FFI::StructLayout::Function</a></li>
        
          <li><a href="../../../FFI/StructLayout/InnerStruct.html">FFI::StructLayout::InnerStruct</a></li>
        
          <li><a href="../../../FFI/StructLayout/Mapped.html">FFI::StructLayout::Mapped</a></li>
        
          <li><a href="../../../FFI/StructLayout/Number.html">FFI::StructLayout::Number</a></li>
        
          <li><a href="../../../FFI/StructLayout/Pointer.html">FFI::StructLayout::Pointer</a></li>
        
          <li><a href="../../../FFI/StructLayout/String.html">FFI::StructLayout::String</a></li>
        
          <li><a href="../../../FFI/StructLayoutBuilder.html">FFI::StructLayoutBuilder</a></li>
        
          <li><a href="../../../FFI/Type.html">FFI::Type</a></li>
        
          <li><a href="../../../FFI/Type/Builtin.html">FFI::Type::Builtin</a></li>
        
          <li><a href="../../../FFI/TypesGenerator.html">FFI::TypesGenerator</a></li>
        
          <li><a href="../../../FFI/Union.html">FFI::Union</a></li>
        
          <li><a href="../../../FFI/VariadicInvoker.html">FFI::VariadicInvoker</a></li>
        
        </ul>
        <div id="no-class-search-results" style="display: none;">No matching classes.</div>
      </div>

      
    </div>
  </div>

  <div id="documentation">
    
<p>#!/bin/sh # install - install a program, script, or datafile</p>

<p>scriptversion=2009-04-28.21; # UTC</p>

<p># This originates from X11R5 (mit/util/scripts/install.sh), which was #
later released in X11R6 (xc/config/util/install.sh) with the # following
copyright and license. # # Copyright (C) 1994 X Consortium # # Permission
is hereby granted, free of charge, to any person obtaining a copy # of this
software and associated documentation files (the "Software"), to # deal in
the Software without restriction, including without limitation the # rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or # sell
copies of the Software, and to permit persons to whom the Software is #
furnished to do so, subject to the following conditions: # # The above
copyright notice and this permission notice shall be included in # all
copies or substantial portions of the Software. # # THE SOFTWARE IS
PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR # IMPLIED,
INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, # FITNESS
FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.  IN NO EVENT SHALL THE # X
CONSORTIUM BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN
# AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN
CONNEC- # TION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
SOFTWARE. # # Except as contained in this notice, the name of the X
Consortium shall not # be used in advertising or otherwise to promote the
sale, use or other deal- # ings in this Software without prior written
authorization from the X Consor- # tium. # # # FSF changes to this file are
in the public domain. # # Calling this script install-sh is preferred over
install.sh, to prevent # `make' implicit rules from creating a file called
install from it # when there is no Makefile. # # This script is compatible
with the BSD install script, but was written # from scratch.</p>

<p>nl=' ' IFS=" ""        $nl"</p>

<p># set DOITPROG to echo to test this script</p>

<p># Don't use :- since 4.3BSD and earlier shells don't like it.
doit=${DOITPROG-} if test -z "$doit"; then</p>

<pre>doit_exec=exec</pre>

<p>else</p>

<pre>doit_exec=$doit</pre>

<p>fi</p>

<p># Put in absolute file names if you don't have them in your path; # or use
environment vars.</p>

<p>chgrpprog=${CHGRPPROG-chgrp} chmodprog=${CHMODPROG-chmod}
chownprog=${CHOWNPROG-chown} cmpprog=${CMPPROG-cmp} cpprog=${CPPROG-cp}
mkdirprog=${MKDIRPROG-mkdir} mvprog=${MVPROG-mv} rmprog=${RMPROG-rm}
stripprog=${STRIPPROG-strip}</p>

<p>posix_glob='?' initialize_posix_glob='</p>

<pre>test &quot;$posix_glob&quot; != &quot;?&quot; || {
  if (set -f) 2&gt;/dev/null; then
    posix_glob=
  else
    posix_glob=:
  fi
}</pre>

<p>'</p>

<p>posix_mkdir=</p>

<p># Desired mode of installed file. mode=0755</p>

<p>chgrpcmd= chmodcmd=$chmodprog chowncmd= mvcmd=$mvprog rmcmd="$rmprog -f"
stripcmd=</p>

<p>src= dst= dir_arg= dst_arg=</p>

<p>copy_on_change=false no_target_directory=</p>

<p>usage="\ Usage: $0 [OPTION]... [-T] SRCFILE DSTFILE</p>

<pre>or: $0 [OPTION]... SRCFILES... DIRECTORY
or: $0 [OPTION]... -t DIRECTORY SRCFILES...
or: $0 [OPTION]... -d DIRECTORIES...</pre>

<p>In the 1st form, copy SRCFILE to DSTFILE. In the 2nd and 3rd, copy all
SRCFILES to DIRECTORY. In the 4th, create DIRECTORIES.</p>

<p>Options:</p>

<pre>   --help     display this help and exit.
   --version  display version info and exit.

-c            (ignored)
-C            install only if different (preserve the last data modification time)
-d            create directories instead of installing files.
-g GROUP      $chgrpprog installed files to GROUP.
-m MODE       $chmodprog installed files to MODE.
-o USER       $chownprog installed files to USER.
-s            $stripprog installed files.
-t DIRECTORY  install into DIRECTORY.
-T            report an error if DSTFILE is a directory.</pre>

<p>Environment variables override the default commands:</p>

<pre>CHGRPPROG CHMODPROG CHOWNPROG CMPPROG CPPROG MKDIRPROG MVPROG
RMPROG STRIPPROG</pre>

<p>"</p>

<p>while test $# -ne 0; do</p>

<pre>case $1 in
  -c) ;;

  -C) copy_on_change=true;;

  -d) dir_arg=true;;

  -g) chgrpcmd=&quot;$chgrpprog $2&quot;
      shift;;

  --help) echo &quot;$usage&quot;; exit $?;;

  -m) mode=$2
      case $mode in
        *' '* | *'    '* | *'</pre>

<p>'*        | *'*'* | *'?'* | *'['*)</p>

<pre>          echo &quot;$0: invalid mode: $mode&quot; &gt;&amp;2
          exit 1;;
      esac
      shift;;

  -o) chowncmd=&quot;$chownprog $2&quot;
      shift;;

  -s) stripcmd=$stripprog;;

  -t) dst_arg=$2
      shift;;

  -T) no_target_directory=true;;

  --version) echo &quot;$0 $scriptversion&quot;; exit $?;;

  --) shift
      break;;

  -*) echo &quot;$0: invalid option: $1&quot; &gt;&amp;2
      exit 1;;

  *)  break;;
esac
shift</pre>

<p>done</p>

<p>if test $# -ne 0 &amp;&amp; test -z "$dir_arg$dst_arg"; then</p>

<pre># When -d is used, all remaining arguments are directories to create.
# When -t is used, the destination is already specified.
# Otherwise, the last argument is the destination.  Remove it from $@.
for arg
do
  if test -n &quot;$dst_arg&quot;; then
    # $@ is not empty: it contains at least $arg.
    set fnord &quot;$@&quot; &quot;$dst_arg&quot;
    shift # fnord
  fi
  shift # arg
  dst_arg=$arg
done</pre>

<p>fi</p>

<p>if test $# -eq 0; then</p>

<pre>if test -z &quot;$dir_arg&quot;; then
  echo &quot;$0: no input file specified.&quot; &gt;&amp;2
  exit 1
fi
# It's OK to call `install-sh -d' without argument.
# This can happen when creating conditional directories.
exit 0</pre>

<p>fi</p>

<p>if test -z "$dir_arg"; then</p>

<pre>trap '(exit $?); exit' 1 2 13 15

# Set umask so as not to create temps with too-generous modes.
# However, 'strip' requires both read and write access to temps.
case $mode in
  # Optimize common cases.
  *644) cp_umask=133;;
  *755) cp_umask=22;;

  *[0-7])
    if test -z &quot;$stripcmd&quot;; then
      u_plus_rw=
    else
      u_plus_rw='% 200'
    fi
    cp_umask=`expr '(' 777 - $mode % 1000 ')' $u_plus_rw`;;
  *)
    if test -z &quot;$stripcmd&quot;; then
      u_plus_rw=
    else
      u_plus_rw=,u+rw
    fi
    cp_umask=$mode$u_plus_rw;;
esac</pre>

<p>fi</p>

<p>for src do</p>

<pre># Protect names starting with `-'.
case $src in
  -*) src=./$src;;
esac

if test -n &quot;$dir_arg&quot;; then
  dst=$src
  dstdir=$dst
  test -d &quot;$dstdir&quot;
  dstdir_status=$?
else

  # Waiting for this to be detected by the &quot;$cpprog $src $dsttmp&quot; command
  # might cause directories to be created, which would be especially bad
  # if $src (and thus $dsttmp) contains '*'.
  if test ! -f &quot;$src&quot; &amp;&amp; test ! -d &quot;$src&quot;; then
    echo &quot;$0: $src does not exist.&quot; &gt;&amp;2
    exit 1
  fi

  if test -z &quot;$dst_arg&quot;; then
    echo &quot;$0: no destination specified.&quot; &gt;&amp;2
    exit 1
  fi

  dst=$dst_arg
  # Protect names starting with `-'.
  case $dst in
    -*) dst=./$dst;;
  esac

  # If destination is a directory, append the input filename; won't work
  # if double slashes aren't ignored.
  if test -d &quot;$dst&quot;; then
    if test -n &quot;$no_target_directory&quot;; then
      echo &quot;$0: $dst_arg: Is a directory&quot; &gt;&amp;2
      exit 1
    fi
    dstdir=$dst
    dst=$dstdir/`basename &quot;$src&quot;`
    dstdir_status=0
  else
    # Prefer dirname, but fall back on a substitute if dirname fails.
    dstdir=`
      (dirname &quot;$dst&quot;) 2&gt;/dev/null ||
      expr X&quot;$dst&quot; : 'X\(.*[^/]\)//*[^/][^/]*/*$' \| \
           X&quot;$dst&quot; : 'X\(//\)[^/]' \| \
           X&quot;$dst&quot; : 'X\(//\)$' \| \
           X&quot;$dst&quot; : 'X\(/\)' \| . 2&gt;/dev/null ||
      echo X&quot;$dst&quot; |
          sed '/^X\(.*[^/]\)\/\/*[^/][^/]*\/*$/{
                 s//\1/
                 q
               }
               /^X\(\/\/\)[^/].*/{
                 s//\1/
                 q
               }
               /^X\(\/\/\)$/{
                 s//\1/
                 q
               }
               /^X\(\/\).*/{
                 s//\1/
                 q
               }
               s/.*/./; q'
    `

    test -d &quot;$dstdir&quot;
    dstdir_status=$?
  fi
fi

obsolete_mkdir_used=false

if test $dstdir_status != 0; then
  case $posix_mkdir in
    '')
      # Create intermediate dirs using mode 755 as modified by the umask.
      # This is like FreeBSD 'install' as of 1997-10-28.
      umask=`umask`
      case $stripcmd.$umask in
        # Optimize common cases.
        *[2367][2367]) mkdir_umask=$umask;;
        .*0[02][02] | .[02][02] | .[02]) mkdir_umask=22;;

        *[0-7])
          mkdir_umask=`expr $umask + 22 \
            - $umask % 100 % 40 + $umask % 20 \
            - $umask % 10 % 4 + $umask % 2
          `;;
        *) mkdir_umask=$umask,go-w;;
      esac

      # With -d, create the new directory with the user-specified mode.
      # Otherwise, rely on $mkdir_umask.
      if test -n &quot;$dir_arg&quot;; then
        mkdir_mode=-m$mode
      else
        mkdir_mode=
      fi

      posix_mkdir=false
      case $umask in
        *[123567][0-7][0-7])
          # POSIX mkdir -p sets u+wx bits regardless of umask, which
          # is incompatible with FreeBSD 'install' when (umask &amp; 300) != 0.
          ;;
        *)
          tmpdir=${TMPDIR-/tmp}/ins$RANDOM-$$
          trap 'ret=$?; rmdir &quot;$tmpdir/d&quot; &quot;$tmpdir&quot; 2&gt;/dev/null; exit $ret' 0

          if (umask $mkdir_umask &amp;&amp;
              exec $mkdirprog $mkdir_mode -p -- &quot;$tmpdir/d&quot;) &gt;/dev/null 2&gt;&amp;1
          then
            if test -z &quot;$dir_arg&quot; || {
                 # Check for POSIX incompatibilities with -m.
                 # HP-UX 11.23 and IRIX 6.5 mkdir -m -p sets group- or
                 # other-writeable bit of parent directory when it shouldn't.
                 # FreeBSD 6.1 mkdir -m -p sets mode of existing directory.
                 ls_ld_tmpdir=`ls -ld &quot;$tmpdir&quot;`
                 case $ls_ld_tmpdir in
                   d????-?r-*) different_mode=700;;
                   d????-?--*) different_mode=755;;
                   *) false;;
                 esac &amp;&amp;
                 $mkdirprog -m$different_mode -p -- &quot;$tmpdir&quot; &amp;&amp; {
                   ls_ld_tmpdir_1=`ls -ld &quot;$tmpdir&quot;`
                   test &quot;$ls_ld_tmpdir&quot; = &quot;$ls_ld_tmpdir_1&quot;
                 }
               }
            then posix_mkdir=:
            fi
            rmdir &quot;$tmpdir/d&quot; &quot;$tmpdir&quot;
          else
            # Remove any dirs left behind by ancient mkdir implementations.
            rmdir ./$mkdir_mode ./-p ./-- 2&gt;/dev/null
          fi
          trap '' 0;;
      esac;;
  esac

  if
    $posix_mkdir &amp;&amp; (
      umask $mkdir_umask &amp;&amp;
      $doit_exec $mkdirprog $mkdir_mode -p -- &quot;$dstdir&quot;
    )
  then :
  else

    # The umask is ridiculous, or mkdir does not conform to POSIX,
    # or it failed possibly due to a race condition.  Create the
    # directory the slow way, step by step, checking for races as we go.

    case $dstdir in
      /*) prefix='/';;
      -*) prefix='./';;
      *)  prefix='';;
    esac

    eval &quot;$initialize_posix_glob&quot;

    oIFS=$IFS
    IFS=/
    $posix_glob set -f
    set fnord $dstdir
    shift
    $posix_glob set +f
    IFS=$oIFS

    prefixes=

    for d
    do
      test -z &quot;$d&quot; &amp;&amp; continue

      prefix=$prefix$d
      if test -d &quot;$prefix&quot;; then
        prefixes=
      else
        if $posix_mkdir; then
          (umask=$mkdir_umask &amp;&amp;
           $doit_exec $mkdirprog $mkdir_mode -p -- &quot;$dstdir&quot;) &amp;&amp; break
          # Don't fail if two instances are running concurrently.
          test -d &quot;$prefix&quot; || exit 1
        else
          case $prefix in
            *\'*) qprefix=`echo &quot;$prefix&quot; | sed &quot;s/'/'\\\\\\\\''/g&quot;`;;
            *) qprefix=$prefix;;
          esac
          prefixes=&quot;$prefixes '$qprefix'&quot;
        fi
      fi
      prefix=$prefix/
    done

    if test -n &quot;$prefixes&quot;; then
      # Don't fail if two instances are running concurrently.
      (umask $mkdir_umask &amp;&amp;
       eval &quot;\$doit_exec \$mkdirprog $prefixes&quot;) ||
        test -d &quot;$dstdir&quot; || exit 1
      obsolete_mkdir_used=true
    fi
  fi
fi

if test -n &quot;$dir_arg&quot;; then
  { test -z &quot;$chowncmd&quot; || $doit $chowncmd &quot;$dst&quot;; } &amp;&amp;
  { test -z &quot;$chgrpcmd&quot; || $doit $chgrpcmd &quot;$dst&quot;; } &amp;&amp;
  { test &quot;$obsolete_mkdir_used$chowncmd$chgrpcmd&quot; = false ||
    test -z &quot;$chmodcmd&quot; || $doit $chmodcmd $mode &quot;$dst&quot;; } || exit 1
else

  # Make a couple of temp file names in the proper directory.
  dsttmp=$dstdir/_inst.$$_
  rmtmp=$dstdir/_rm.$$_

  # Trap to clean up those temp files at exit.
  trap 'ret=$?; rm -f &quot;$dsttmp&quot; &quot;$rmtmp&quot; &amp;&amp; exit $ret' 0

  # Copy the file name to the temp name.
  (umask $cp_umask &amp;&amp; $doit_exec $cpprog &quot;$src&quot; &quot;$dsttmp&quot;) &amp;&amp;

  # and set any options; do chmod last to preserve setuid bits.
  #
  # If any of these fail, we abort the whole thing.  If we want to
  # ignore errors from any of these, just make sure not to ignore
  # errors from the above &quot;$doit $cpprog $src $dsttmp&quot; command.
  #
  { test -z &quot;$chowncmd&quot; || $doit $chowncmd &quot;$dsttmp&quot;; } &amp;&amp;
  { test -z &quot;$chgrpcmd&quot; || $doit $chgrpcmd &quot;$dsttmp&quot;; } &amp;&amp;
  { test -z &quot;$stripcmd&quot; || $doit $stripcmd &quot;$dsttmp&quot;; } &amp;&amp;
  { test -z &quot;$chmodcmd&quot; || $doit $chmodcmd $mode &quot;$dsttmp&quot;; } &amp;&amp;

  # If -C, don't bother to copy if it wouldn't change the file.
  if $copy_on_change &amp;&amp;
     old=`LC_ALL=C ls -dlL &quot;$dst&quot;     2&gt;/dev/null` &amp;&amp;
     new=`LC_ALL=C ls -dlL &quot;$dsttmp&quot;  2&gt;/dev/null` &amp;&amp;

     eval &quot;$initialize_posix_glob&quot; &amp;&amp;
     $posix_glob set -f &amp;&amp;
     set X $old &amp;&amp; old=:$2:$4:$5:$6 &amp;&amp;
     set X $new &amp;&amp; new=:$2:$4:$5:$6 &amp;&amp;
     $posix_glob set +f &amp;&amp;

     test &quot;$old&quot; = &quot;$new&quot; &amp;&amp;
     $cmpprog &quot;$dst&quot; &quot;$dsttmp&quot; &gt;/dev/null 2&gt;&amp;1
  then
    rm -f &quot;$dsttmp&quot;
  else
    # Rename the file to the real destination.
    $doit $mvcmd -f &quot;$dsttmp&quot; &quot;$dst&quot; 2&gt;/dev/null ||

    # The rename failed, perhaps because mv can't rename something else
    # to itself, or perhaps because mv is so ancient that it does not
    # support -f.
    {
      # Now remove or move aside any old file at destination location.
      # We try this two ways since rm can't unlink itself on some
      # systems and the destination file might be busy for other
      # reasons.  In this case, the final cleanup might fail but the new
      # file should still install successfully.
      {
        test ! -f &quot;$dst&quot; ||
        $doit $rmcmd -f &quot;$dst&quot; 2&gt;/dev/null ||
        { $doit $mvcmd -f &quot;$dst&quot; &quot;$rmtmp&quot; 2&gt;/dev/null &amp;&amp;
          { $doit $rmcmd -f &quot;$rmtmp&quot; 2&gt;/dev/null; :; }
        } ||
        { echo &quot;$0: cannot unlink or rename $dst&quot; &gt;&amp;2
          (exit 1); exit 1
        }
      } &amp;&amp;

      # Now rename the file to the real destination.
      $doit $mvcmd &quot;$dsttmp&quot; &quot;$dst&quot;
    }
  fi || exit 1

  trap '' 0
fi</pre>

<p>done</p>

<p># Local variables: # eval: (add-hook 'write-file-hooks 'time-stamp) #
time-stamp-start: "scriptversion=" # time-stamp-format:
"%:y-%02m-%02d.%02H" # time-stamp-time-zone: "UTC" # time-stamp-end: "; #
UTC" # End:</p>

  </div>

  <div id="validator-badges">
    <p><small><a href="http://validator.w3.org/check/referer">[Validate]</a></small></p>
    <p><small>Generated with the <a href="http://deveiate.org/projects/Darkfish-Rdoc/">Darkfish
      Rdoc Generator</a> 2</small>.</p>
  </div>
</body>
</html>

